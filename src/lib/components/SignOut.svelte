<script>
	import { supabase } from '$lib/supabaseClient';
	import { user } from '$lib/stores/sessionStore';

	let message = '';
	let loading = false;
	// user.set = supabase.auth.user();

	async function signOut() {
		try {
			loading = true;
			let { error } = await supabase.auth.signOut();
			if (error) {
				throw error;
			} else {
				message = 'You have signed out';
			}
		} catch (error) {
			// looks like there's a bug in Supabase here that throws an error on signout, but it can be ignored
			message = `You have signed out`;
			console.warning(error);
		} finally {
			loading = false;
			user.set(null);
			console.log($user);
		}
	}
</script>

<button on:click={signOut} disabled={loading}> Sign Out </button>

{#if message}
	<p>{message}</p>
{/if}

<style>
</style>
